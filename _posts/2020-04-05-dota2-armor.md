---
layout: post
title: 用MATLAB逆推DOTA2护甲值和物理减伤比例公式
date:   2020-04-05
categories: 数值
tag: 设计
---

* content
{:toc}


序章			
====================================
玩了多年dota2，虽然知道DOTA2护甲值对应物理减少比例是具有边际递减效应的，但是一直没有注意过具体公式是什么，这次就心血来潮的用MATLAB逆推一下DOTA2中的护甲对应物理减伤率的公式。  


# 获得数据  
这一步很简单，直接在斧王岛上选两个英雄，一级一级的升级，摘抄下不同护甲值对应的减伤率，放到Excel中建立成对应的两列数据。  
![1]({{ '/styles/images/2020-04-05/1.png' | prepend: site.baseurl  }})  
然后将数据导入到MATLAB当中，将两列数据转换为两个列矢量，然后进行函数拟合。  

# 得出结果  
使用不同的常见游戏计算公式进行拟合，公式自然不可能是一些7次8次的函数，哪怕那种函数拟合度非常高。  
![2]({{ '/styles/images/2020-04-05/2.png' | prepend: site.baseurl  }})    
最终我选用了有理数逼近，分子分母自由度为1时得出的公式，其中``SSE（和方差）``以及``R-square（确定系数）``都可以代表拟合置信度，SSE越接近0，R-square越接近1，那么拟合结果就越真实。  
我们得出公式就是减伤率=（1.08 * 护甲-0.059）/（护甲+18.9）  
当然存在一定的误差，因为我们在游戏中所抄录的护甲值和减伤率都是进行了有效位数保留的。  
# 结论  
而后，我翻找了一下dota2的更新日志，发现在7.20的版本更新中，公布了护甲减伤公式更改为：（0.052 * 护甲）/（0.9+ 0.048 * 护甲）  
换算成我们得出的公式类似的形式的话是：（1.083 * 护甲）/（护甲+18.75）  。  
可以看出拟合结论还是十分可信的，带入到游戏中也是可以验证的。  
**当护甲值为负数时**，我摘取了一些数据，发现和护甲为正时绝对值相等，那么这个护甲值函数是个奇函数。  
有了公式之后不难得出，在护甲值越接近0的时候，不论是我方加甲还是敌方减价，收益都是越高。也就是在敌人高护甲的时候减甲效果远不如低护甲时，这也就是为什么黯灭是个前中期物理装备，到了后期英雄护甲不论是通过属性还是装备堆了起来的时候，黯灭的减甲效果就没有那么明显了。  
其实本文是在做完了之后才发现游戏公布了该公式，但是也提供了一个逆推思路。逆推一个游戏的数值自然是从这些小的模块去一块一块逆推，各个击破。